---
title: "Data Analysis"
author: "Tim Abramov"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr) ##for different filter()
library(e1071) ##needed for normality graphs
library(mosaic)##favstats

games_features <- read_xlsx("games_features.xlsx")
##we need only games:
games <- filter(games_features, GenreIsNonGame == FALSE)
```

## Question 1
__"Are there any qualitative differences that can be measured between games that received a Metacritic score and those that didn't?"__
```{r echo = FALSE}
##then group by if metacritic != 0 (one group of games that received the score, and one that didn't)

```


## Question 2
__"Does the number of game screenshots have a measurable effect on the sales of the game?"__

To visualize the relationship, let's graph a scatterplot first:
```{r echo = FALSE}
##ScreenshotCount vs. SteamSpyOwners
##1. Scatterplot, to visualize the relationship
scatter.smooth(x=games$ScreenshotCount, y=games$SteamSpyOwners, main="ScreenshotCount ~ SteamSpyOwners")
```

Not much can be seen at that scale, there seems to be many outliers. 

Speaking of which, to see if we have any outliers (and how many), let's graph boxplots for both the "ScreenshotCount" and "SteamSpyOwners":
```{r echo = FALSE}
##2. BoxPlots
par(mfrow=c(1, 2))  # divide graph area in 2 columns
boxplot(games$ScreenshotCount, main="ScreenshotCount",
sub=paste("Outliers: ", length(boxplot.stats(games$ScreenshotCount)$out)))  # box plot for ScreenshotCount
boxplot(games$SteamSpyOwners, main="SteamSpyOwners",
sub=paste("Outliers: ", length(boxplot.stats(games$SteamSpyOwners)$out)))  # box plot for SteamSpyOwners
```

As you can see, we have quite a few outliers. 530(around 4% of the dataset) for number of screenshots for a game, and 1981 (around 15% of the dataset) for number of owners for a game!


Next, let's look at distributions of our variables. Ideally our predictor variable(number of screenshots) should be close to being normally distributed: 

```{r echo = FALSE}
##3. Density plot (check for normality of the data)
par(mfrow=c(1, 2))  # divide graph area in 2 columns
plot(density(games$ScreenshotCount), main="Density Plot: ScreenshotCount", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(games$ScreenshotCount), 2)))  # density plot for ScreenshotCount
polygon(density(games$ScreenshotCount), col="red")
plot(density(games$SteamSpyOwners), main="Density Plot: SteamSpyOwners", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(games$SteamSpyOwners), 2)))  # density plot for 'dist'
polygon(density(games$SteamSpyOwners), col="red")
##favstats(games$SteamSpyOwners)
```

Distribution for our number of screenshots is right skewed, which is not ideal, but it might work alright.
And note on distribution of owners for games: many games have close to no owners and only a few have some pretty high number of owners.

Finally, let's look at the correlation of those two variables and create a linear regression model for it:
Corellation:
```{r}
cor(games$SteamSpyOwners, games$ScreenshotCount)
```

As we can see, correlation is positive and relatively strong.
Let's see what kind of model do we get out of it:

```{r}
screen_mod <- lm(SteamSpyOwners ~ ScreenshotCount, data = games)
summary(screen_mod)
```

From the data above we can construct our equation for linear regression:
SteamSpyOwners = 41296 + (13445 * ScreenshotCount)
Next up, we have some p-values for both of the variables. Ho for a linear regression is that both coefficients associated with variables are 0. Ha is that they're not 0, thus there exists a relationship between the independent variable in question and the dependent variable.
Since two of our p-values are less than our threshold (significance level of 0.05), we can reject the Ho and conclude that this model is statistically significant. 
And while the model constructed is far from ideal, we proved that number of screenshots does have an impact on how many people buy it.

## Question 3
__"Is there an association between how many copies of the game were sold and the price of the game?"__

To visualize the relationship, let's graph a scatterplot first:

```{r echo = FALSE}
##ScreenshotCount vs. SteamSpyOwners
##1. Scatterplot, to visualize the relationship
scatter.smooth(x=games$PriceFinal, y=games$SteamSpyOwners, main="PriceFinal ~ SteamSpyOwners")
```

As with previous question, can't really say much at this stage. But there seems to be visible a positive trend.

Let's graph boxplots for both the "PriceFinal" and "SteamSpyOwners":
```{r echo = FALSE}
##2. BoxPlots
par(mfrow=c(1, 2))  # divide graph area in 2 columns
boxplot(games$PriceFinal, main="PriceFinal",
sub=paste("Outliers: ", length(boxplot.stats(games$PriceFinal)$out)))  # box plot for ScreenshotCount
boxplot(games$SteamSpyOwners, main="SteamSpyOwners",
sub=paste("Outliers: ", length(boxplot.stats(games$SteamSpyOwners)$out)))  # box plot for SteamSpyOwners
```

Number of outlier is similar to previous question. 660(around 5% of the dataset) for final price for a game, and 1981 (around 15% of the dataset) for number of owners! What is pretty interesting, is that most games are bellow $25 mark, which makes sense, just never thought of it before.


Next, let's look at distributions of our variables. Ideally our predictor variable(PriceFinal) should be close to being normally distributed: 

```{r echo = FALSE}
##3. Density plot (check for normality of the data)
par(mfrow=c(1, 2))  # divide graph area in 2 columns
plot(density(games$PriceFinal), main="Density Plot: PriceFinal", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(games$PriceFinal), 2)))  # density plot for PriceFinal
polygon(density(games$ScreenshotCount), col="red")
plot(density(games$SteamSpyOwners), main="Density Plot: SteamSpyOwners", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(games$SteamSpyOwners), 2)))  # density plot for 'dist'
polygon(density(games$SteamSpyOwners), col="red")
```

Distribution for price of a game is right skewed which is to be expected.

Finally, let's look at the correlation of those two variables and create a linear regression model for it:
Corellation:
```{r}
cor(games$SteamSpyOwners, games$PriceFinal)
```

Correlation is positive and moderately strong.
Let's see what kind of model do we get out of it:

```{r}
screen_mod <- lm(SteamSpyOwners ~ PriceFinal, data = games)
summary(screen_mod)
```

From the data above we can construct our equation for linear regression:
SteamSpyOwners = 118436 + (6360 * PriceFinal)
Both of our p-values are really close to 0, thus we can reject the null hypothesis and conclude that this model is statistically significant. 


