---
title: "Data Analysis"
author: "Tim Abramov"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr) ##for different filter()
library(e1071) ##needed for normality graphs
library(mosaic)##favstats

games_features <- read_xlsx("games_features.xlsx")
##we need only games:
games <- filter(games_features, GenreIsNonGame == FALSE)
```

## Question 1
__"Are there any qualitative differences that can be measured between games that received a Metacritic score and those that didn't?"__
```{r echo = FALSE}
##then group by if metacritic != 0 (one group of games that received the score, and one that didn't)

```


## Question 2
__"Does the number of game screenshots have a measurable effect on the sales of the game?"__

To visualize the relationship, let's graph a scatterplot first:
```{r echo = FALSE}
##ScreenshotCount vs. SteamSpyOwners
##1. Scatterplot, to visualize the relationship
scatter.smooth(x=games$ScreenshotCount, y=games$SteamSpyOwners, main="ScreenshotCount ~ SteamSpyOwners")
##gf_point(SteamSpyOwners ~ ScreenshotCount, data = games)
```

Not much can be seen at that scale, too be many outliers. 

Speaking of which, to see if we have any outliers (and how many), let's graph boxplots for both the "ScreenshotCount" and "SteamSpyOwners":
```{r echo = FALSE}
##2. BoxPlots
par(mfrow=c(1, 2))  # divide graph area in 2 columns
boxplot(games$ScreenshotCount, main="ScreenshotCount",
sub=paste("Outliers: ", length(boxplot.stats(games$ScreenshotCount)$out)))  # box plot for ScreenshotCount
boxplot(games$SteamSpyOwners, main="SteamSpyOwners",
sub=paste("Outliers: ", length(boxplot.stats(games$SteamSpyOwners)$out)))  # box plot for SteamSpyOwners
```

As you can see, we have quite a few outliers. 530(around 4% of the dataset) for number of screenshots for a game, and 1981 (around 15% of the dataset) for number of owners for a game! To proceed with linear regression, we will need to deal with those outliers.







```{r echo = FALSE}
##cor(games$SteamSpyOwners, games$ScreenshotCount)
```



```{r echo = FALSE}
##screen_mod <- lm(SteamSpyOwners ~ ScreenshotCount, data = games)
##summary(screen_mod)
##mplot(screen_mod, which = 1)
```



## Question 3
__"Is there an association between how many copies of the game were sold and the price of the game?"__

To visualize the relationship, let's graph a scatterplot first:

```{r echo = FALSE}
##ScreenshotCount vs. SteamSpyOwners
##1. Scatterplot, to visualize the relationship
scatter.smooth(x=games$PriceFinal, y=games$SteamSpyOwners, main="PriceFinal ~ SteamSpyOwners")
```

As with previous question, can't really say much at this stage. Again, problems with outliers

Let's graph boxplots for both the "PriceFinal" and "SteamSpyOwners":
```{r echo = FALSE}
##2. BoxPlots
par(mfrow=c(1, 2))  # divide graph area in 2 columns
boxplot(games$PriceFinal, main="PriceFinal",
sub=paste("Outliers: ", length(boxplot.stats(games$PriceFinal)$out)))  # box plot for ScreenshotCount
boxplot(games$SteamSpyOwners, main="SteamSpyOwners",
sub=paste("Outliers: ", length(boxplot.stats(games$SteamSpyOwners)$out)))  # box plot for SteamSpyOwners
```

Number of outlier is similar to previous question. 660(around 5% of the dataset) for final price for a game, and 1981 (around 15% of the dataset) for number of owners! What is pretty interesting, is that most games are bellow $25 mark, which makes sense, just never thought of it before. Before we move on to the next stage, something needs to be done about those outliers.




```{r echo = FALSE}
##cor(games$SteamSpyOwners, games$PriceFinal)
```



```{r echo = FALSE}
price_mod <- lm(SteamSpyOwners ~ PriceFinal, data = games)
##summary(screen_mod)
##mplot(price_mod, which = 1)
```




